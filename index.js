/*!
 * write <https://github.com/knowcss/knowedcss>
 *
 * Copyright (c) 2021 Jeremy Anderson.
 * Released under the MIT License.
 */

'use strict';

const replace = require('replace');

/**
 * ```js
 * var knowedCSS = require('knowedcss');
 * var cssHTML = knowedCSS('html');
 * // returns an array of [updated html, new css]
 * ```
 *
 * @name writeFile
 * @param  {String} `html` html with KnowCSS markup
 * @api public
 */

/*jshint esversion: 6 */

var cssVars={},hexColors={pink:"ffc0cb",lightpink:"ffb6c1",palevioletred:"db7093",hotpink:"ff69b4",deeppink:"ff1493",mediumvioletred:"c71585",lavender:"e6e6fa",thistle:"d8bfd8",plum:"dda0dd",orchid:"da70d6",violet:"ee82ee",fuchsia:"ff00ff",magenta:"ff00ff",mediumorchid:"ba55d3",darkorchid:"9932cc",darkviolet:"9400d3",blueviolet:"8a2be2",darkmagenta:"8b008b",purple:"800080",mediumpurple:"9370db",mediumslateblue:"7b68ee",slateblue:"6a5acd",darkslateblue:"483d8b",rebeccapurple:"663399","indigo ":"4b0082",lightsalmon:"ffa07a",salmon:"fa8072",darksalmon:"e9967a",lightcoral:"f08080","indianred ":"cd5c5c",crimson:"dc143c",red:"ff0000",firebrick:"b22222",darkred:"8b0000",orange:"ffa500",darkorange:"ff8c00",coral:"ff7f50",tomato:"ff6347",orangered:"ff4500",gold:"ffd700",yellow:"ffff00",lightyellow:"ffffe0",lemonchiffon:"fffacd",lightgoldenrodyellow:"fafad2",papayawhip:"ffefd5",moccasin:"ffe4b5",peachpuff:"ffdab9",palegoldenrod:"eee8aa",khaki:"f0e68c",darkkhaki:"bdb76b",greenyellow:"adff2f",chartreuse:"7fff00",lawngreen:"7cfc00",lime:"00ff00",limegreen:"32cd32",palegreen:"98fb98",lightgreen:"90ee90",mediumspringgreen:"00fa9a",springgreen:"00ff7f",mediumseagreen:"3cb371",seagreen:"2e8b57",forestgreen:"228b22",green:"008000",darkgreen:"006400",yellowgreen:"9acd32",olivedrab:"6b8e23",darkolivegreen:"556b2f",mediumaquamarine:"66cdaa",darkseagreen:"8fbc8f",lightseagreen:"20b2aa",darkcyan:"008b8b",teal:"008080",aqua:"00ffff",cyan:"00ffff",lightcyan:"e0ffff",paleturquoise:"afeeee",aquamarine:"7fffd4",turquoise:"40e0d0",mediumturquoise:"48d1cc",darkturquoise:"00ced1",cadetblue:"5f9ea0",steelblue:"4682b4",lightsteelblue:"b0c4de",lightblue:"add8e6",powderblue:"b0e0e6",lightskyblue:"87cefa",skyblue:"87ceeb",cornflowerblue:"6495ed",deepskyblue:"00bfff",dodgerblue:"1e90ff",royalblue:"4169e1",blue:"0000ff",mediumblue:"0000cd",darkblue:"00008b",navy:"000080",midnightblue:"191970",cornsilk:"fff8dc",blanchedalmond:"ffebcd",bisque:"ffe4c4",navajowhite:"ffdead",wheat:"f5deb3",burlywood:"deb887",tan:"d2b48c",rosybrown:"bc8f8f",sandybrown:"f4a460",goldenrod:"daa520",darkgoldenrod:"b8860b",peru:"cd853f",chocolate:"d2691e",olive:"808000",saddlebrown:"8b4513",sienna:"a0522d",brown:"a52a2a",maroon:"800000",white:"ffffff",snow:"fffafa",honeydew:"f0fff0",mintcream:"f5fffa",azure:"f0ffff",aliceblue:"f0f8ff",ghostwhite:"f8f8ff",whitesmoke:"f5f5f5",seashell:"fff5ee",beige:"f5f5dc",oldlace:"fdf5e6",floralwhite:"fffaf0",ivory:"fffff0",antiquewhite:"faebd7",linen:"faf0e6",lavenderblush:"fff0f5",mistyrose:"ffe4e1",gainsboro:"dcdcdc",lightgray:"d3d3d3",silver:"c0c0c0",darkgray:"a9a9a9",dimgray:"696969",gray:"808080",lightslategray:"778899",slategray:"708090",darkslategray:"2f4f4f",black:"000000"},knownResponsive={xxsm:["1","479"],xsm:["480","639"],sm:["640","767"],md:["768","1023"],lg:["1024","1535"],xl:["1536","1919"],xxl:["1920","9999"],1:["1","479"],480:["480","639"],640:["640","767"],768:["768","1023"],1024:["1024","1535"],1536:["1536","1919"],1920:["1920","9999"],print:["0","99999"]},knownCSS={nowrap:"white-space-nowrap",italic:"font-style-italic",bg:"background-color","bg-color":"background-color",back:"background-color",light:"font-weight-300",normal:"font-weight-400",medium:"font-weight-500",semibold:"font-weight-600",bold:"font-weight-700",hidden:"visibility-hidden",visible:"visibility-visible",none:"display-none",block:"display-block",inline:"display-inline","inline-block":"display-inline-block",center:"margin-0/auto",aligncenter:"text-align-center",aligntop:"vertical-align-top",alignmiddle:"vertical-align-middle",alignbottom:"vertical-align-bottom",underline:"text-decoration-underline",nounderline:"text-decoration-none",table:"display-table",collapse:"border-collapse-collapse",separate:"border-collapse-separate",row:"display-table-row",cell:"display-table-cell",full:"width-pct100",half:"width-pct50"},knownIDS={},sameCSS={},customCSS={},groupCSS={},responsiveCSS={},fixedCSS={},prevClasses={},originalCSS={};function hiwindTabs(e){var i=null;i=e.length>0?e:document.getElementsByTagName("textarea");for(var n=0;n<i.length;n++)i[n].onkeydown=function(e){if(9==e.keyCode||9==e.which){e.preventDefault();var i=this.selectionStart;this.value=this.value.substring(0,this.selectionStart)+"\t"+this.value.substring(this.selectionEnd),this.selectionEnd=i+1}}}function hiwindEditor(e){if(hiwindLayer(e)){var i=window.open("","KnowCSS Editor","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height="+screen.height+",top=0,left="+(screen.width-600)),n=e in originalCSS?originalCSS[e]:e.innerText;n=htmlEntities(n.toString().replace(/\n\t/gi,"\n")),i.document.body.innerHTML='<style>body{padding:0px;margin:0px;height:100%;width:100%;}textarea{box-sizing:border-box;font-family:verdana;font-size:12px;border:0px;padding:3px}</style><textarea style="width:100%; height:100%;" onKeyUp="window.opener.hiwindApply(this, \''+e+"'); return true;\" onkeydown=\"e=event; if ((e.keyCode==9) || (e.which==9)) { e.preventDefault(); var s = this.selectionStart; this.value = this.value.substring(0,this.selectionStart) + '\\t' + this.value.substring(this.selectionEnd); this.selectionEnd = s+1; }\">"+n+"</textarea>"}}function hiwindID(e){var i="abcdefghijklmnopqrstuvwxyz",n=i[Math.floor(Math.random()*i.length)]+Math.random().toString(36).substr(2,e);return n in knownIDS?n=hiwindID(e):knownIDS[n]=!0,n}function hiwindToHex(e){var i=e.toString(16);return 1==i.length?"0"+i:i}function hiwindShade(e,i){var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),t=[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)],r=i/100;return t[0]=Math.ceil(t[0]*r),t[1]=Math.ceil(t[1]*r),t[2]=Math.ceil(t[2]*r),hiwindToHex(t[0])+hiwindToHex(t[1])+hiwindToHex(t[2])}function hiwindHex(e){for(var i="",n=[],t=e,r=new RegExp("^([a-fA-F0-9]{6})$","i");null!==(i=r.exec(t));){(n=i[1].split(""))[0]==n[1]&&n[2]==n[3]&&n[4]==n[5]&&(e=n[0]+n[2]+n[4]);break}return e}function hiwindLayer(e){return document.getElementById(e)}function hiwindEdit(e,i){hiwindLayer(i).value=hiwindLayer(e).innerHTML}function hiwindExample(e,i){hiwindLayer(i).innerText=hiwindLayer(e).innerHTML.trim()}function htmlEntities(e){return e.toString().toString().replace(/&/g,"&amp;").toString().replace(/</g,"&lt;").toString().replace(/>/g,"&gt;").toString().replace(/"/g,"&quot;").toString()}function hiwindClass(e){var i="",n="";return e.indexOf("-webkit-")>-1?(e=e.toString().replace("-webkit-","webkit-"),i="-"):e.indexOf("-moz-")>-1?(e=e.toString().replace("-moz-","moz-"),i="-"):e.indexOf("-ms-")>-1?(e=e.toString().replace("-ms-","ms-"),i="-"):e.indexOf("-o-")>-1&&(e=e.toString().replace("-o-","o-"),i="-"),e.indexOf("-pct-")>-1?e=e.toString().replace("-pct-","-")+"%":e.indexOf("-pct")>-1&&(e=e.toString().replace("-pct","-")+"%"),e.indexOf("-percent-")>-1?e=e.toString().replace("-percent-","-")+"%":e.indexOf("-percent")>-1&&(e=e.toString().replace("-percent","-")+"%"),[e,n]=hiwindImportant(e,"","!"),(e=e.toString().replace(/\-{1,100}$/g,"")).indexOf("--")>-1&&(e=e.toString().replace(/\-\-/g,"-")),[e,i,n]}function hiwindSafeClass(e){return(e=e.toString().replace(/\%/g,"-pct").toString().replace(/[^a-zA-Z0-9\-]/g,"-").toString().replace(/\-{1,100}$/g,"")).indexOf("--")>-1&&(e=e.toString().replace(/\-\-/g,"-")),e}function hiwindModifier(e){var i="",n="";return 0==e.indexOf("+")?n="."+e.substr(1)+" ":"all"==e?i=" *":["important","!","!important"].includes(e)||(0==e.indexOf("all-")?i=" "+e.toString().replace("all-",""):e.indexOf("nth-child")>-1?i=":nth-child("+e.toString().replace("nth-child-","")+")":hiwindCheckModifier(e)?i=" *:"+e:"main"!==e&&(i=":"+e)),[i,n,""]}function hiwindCheckModifier(e){return e.indexOf("nth-child")>-1||(!!["last-child","first-child","only-child","first-of-type","last-of-type","only-of-type"].includes(e)||!!["placeholder","after","before","first-letter","first-line","selection","marker"].includes(e))}function getHead(){return document.getElementsByTagName("html")[0]}function KnowCSS(e){var i=hiwindCSS(e,null,null),n="css_"+e,t=getHead();if(hiwindLayer(n))i[3]&&(hiwindLayer(n).innerHTML=i[1]);else{var r=document.createElement("style");r.innerHTML=i[1],r.id=n,t.appendChild(r)}hiwindLayer(e).innerHTML=i[2]}function insertAndExecute(e,i){e.innerHTML=i;for(var n=[],t=e.childNodes,r=0;t[r];r++)!n||!hiwindNode(t[r],"script")||t[r].type&&"text/javascript"!==t[r].type.toLowerCase()||n.push(t[r].parentNode?t[r].parentNode.removeChild(t[r]):t[r]);for(var o in n)"string"==typeof o&&evalScript(n[o])}function hiwindNode(e,i){return e.nodeName&&e.nodeName.toUpperCase()===i.toUpperCase()}function evalScript(e){var i=e.text||e.textContent||e.innerHTML||"",n=document.getElementsByTagName("head")[0]||document.documentElement,t=document.createElement("script");t.type="text/javascript",t.appendChild(document.createTextNode(i)),n.insertBefore(t,n.firstChild),n.removeChild(t),e.parentNode&&e.parentNode.removeChild(e)}function hiwindApply(e,i){var n=hiwindLayer(i);n&&originalCSS[i]!==e.value&&(originalCSS[i]=e.value,insertAndExecute(n,e.value),KnowCSS(i))}function hiwindImportant(e,i,n){var t="",r=n+"important";return e.indexOf("-important-")>-1?(e=e.toString().replace("-important-","-"),t=r):e.indexOf("-important")>-1?(e=e.toString().replace("-important",""),t=r):e.indexOf("!")>-1?(e=e.toString().replace("!",""),t=r):["important","!","!important"].includes(i)?t=r:i.indexOf("-!-")>-1?(i=i.toString().replace("-!-","-"),t=r):i.indexOf("-!")>-1?(i=i.toString().replace("-!",""),t=r):i.indexOf("!")>-1?(i=i.toString().replace("!",""),t=r):t="",[e,t]}var wK=["align-content","align-items","align-self","alt","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","animation-trigger","app-region","appearance","aspect-ratio","backdrop-filter","backface-visibility","background-clip","background-composite","background-origin","background-size","border-after-color","border-after-style","border-after-width","border-after","border-before-color","border-before-style","border-before-width","border-before","border-bottom-left-radius","border-bottom-right-radius","border-end-color","border-end-style","border-end-width","border-end","border-fit","border-horizontal-spacing","border-image","border-radius","border-start-color","border-start-style","border-start-width","border-start","border-top-left-radius","border-top-right-radius","border-vertical-spacing","box-align","box-decoration-break","box-direction","box-flex-group","box-flex","box-lines","box-ordinal-group","box-orient","box-pack","box-reflect","box-shadow","box-sizing","clip-path","color-correction","column-axis","column-break-after","column-break-before","column-break-inside","column-count","column-fill","column-gap","column-progression","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","cursor-visibility","dashboard-region","device-pixel-ratio","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","flow-from","flow-into","font-feature-settings","font-kerning","font-size-delta","font-smoothing","font-variant-ligatures","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","highlight","hyphenate-character","hyphenate-charset","hyphenate-limit-after","hyphenate-limit-before","hyphenate-limit-lines","hyphens","initial-letter","justify-content","justify-items","justify-self","line-align","line-box-contain","line-break","line-clamp","line-grid","line-snap","locale","logical-height","logical-width","margin-after","margin-after-collapse","margin-before","margin-before-collapse","margin-bottom-collapse","margin-collapse","margin-end","margin-start","margin-top-collapse","marquee","marquee-direction","marquee-increment","marquee-repetition","marquee-speed","marquee-style","mask","mask-attachment","mask-box-image","mask-box-image-outset","mask-box-image-repeat","mask-box-image-slice","mask-box-image-source","mask-box-image-width","mask-clip","mask-composite","mask-image","mask-origin","mask-position","mask-position-x","mask-position-y","mask-repeat","mask-repeat-x","mask-repeat-y","mask-size","mask-source-type","match-nearest-mail-blockquote-color","max-logical-height","max-logical-width","media-text-track-container","min-logical-height","min-logical-width","nbsp-mode","opacity","order","overflow-scrolling","padding-after","padding-before","padding-end","padding-start","perspective","perspective-origin","perspective-origin-x","perspective-origin-y","print-color-adjust","region-break-after","region-break-before","region-break-inside","region-fragment","rtl-ordering","ruby-position","scroll-snap-type","shape-image-threshold","shape-inside","shape-margin","shape-outside","svg-shadow","tap-highlight-color","text-color-decoration","text-combine","text-decoration-line","text-decoration-skip","text-decoration-style","text-decorations-in-effect","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-fill-color","text-justify","text-orientation","text-security","text-size-adjust","text-stroke","text-stroke-color","text-stroke-width","text-underline-position","text-zoom","transform","transform-2d","transform-3d","transform-origin","transform-origin-x","transform-origin-y","transform-origin-z","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","user-drag","user-modify","user-select","animating-full-screen-transition","any-link","autofill","autofill-strong-password","drag","full-page-media","full-screen-ancestor","full-screen-controls-hidden","full-screen-document","full-screen","file-upload-button","inner-spin-button","input-placeholder","media-controls","media-controls-current-time-display","media-controls-enclosure","media-controls-fullscreen-button","media-controls-mute-button","media-controls-overlay-enclosure","media-controls-panel","media-controls-play-button","media-controls-time-remaining-display","media-controls-timeline","media-controls-toggle-closed-captions-button","media-controls-volume-control-container","media-controls-volume-control-hover-background","media-controls-volume-slider","meter-bar","meter-even-less-good-value","meter-inner-element","meter-optimum-value","meter-suboptimum-value","outer-spin-button","progress-bar","progress-inner-element","progress-value","search-cancel-button","search-results-button","slider-runnable-track","slider-thumb"],wY="^"+wK.join("|").toString().replace("/-/gi","\\-");function hiwindWebKit(e){return new RegExp(wY).test(e)}function hiwindCSS(e,i,n){var t,r={minifyhtml:!0,minifycss:!0,minifyclasses:!0},o=!1===r.minifycss?["\n","\n\t","\n\t\t"]:["","",""],a=new RegExp("class=[\"|'](.*?)[\"|']","gis"),l=new RegExp("^([0-9a-f]{3,6})$","i"),s=new RegExp("\\[(.*?)\\]","i"),d=new RegExp("([a-zA-Z0-9-+>~*]{1,32}){(.*?)}","gis"),f=new RegExp("^([0-9]{1,6})$","i"),c=new RegExp("^([0-9]{1,6})$","i"),g=new RegExp("([a-zA-Z0-9-]{1,32})\\(\\((.*?)\\)\\)","gis"),p=new RegExp("\\{\\{\\$(.*?)\\}\\}","gi"),m=!1,h="define{display:none!important;visibility:hidden!important;height:0px!important;width:0px!important;padding:0px!important;margin:0px!important}",u="",b=0,S="",w="",x="",y="",v={},k=[],C="",O="",E="",L="",z="",M="",j="",R=[],T="",q={},H="",I={},N="",D="",A="",K=[],$="",B="",V="",_=[],U={},Z="",W="",Y=[],F="",G=!1,J="",P="",Q="",X="",ee="",ie="",ne="",te="",re="",oe=0,ae="",le="",se=[],de="",fe="",ce=[],ge="",pe="",me=[],he="",ue="",be="",Se="",we=[];if("string"==typeof e?(ge=hiwindLayer(e))&&(e="textarea"==ge.tagName.toLowerCase()?ge.value:ge.innerHTML):"object"==typeof e?(ge=e,e=e.innerHTML):ge=e,"object"==typeof n)for(var xe in n)xe in r&&(r[xe]=n[xe]);sameCSS={},customCSS={},knownIDS={},groupCSS={},responsiveCSS={},fixedCSS={};var ye=ge.id;ye in originalCSS==!1&&(originalCSS[ye]=e),X=e;for(;null!==(w=p.exec(e));)Q="","object"==typeof cssVars&&w[1]in cssVars&&(Q=cssVars[w[1]]),X=X.toString().replace(w[0],Q);for(u=X,e=X,X="",t=e.toString().replace(/[\s\n\r]/gi,"");null!==(S=a.exec(e));){for(T="",q={},I={},A="",K=[],M=N=S[1],j="",se=[];null!==(x=d.exec(N));){!1===hiwindCheckModifier[x[1]]&&x[1].indexOf("-")>-1&&((me=x[1].split("-",2))[1]in knownResponsive?(x[1]=me[1],x[2]=me[0]+"("+x[2]+")"):(x[1]=me[0],x[2]=me[1]+"("+x[2]+")")),x[1]in knownResponsive&&(x[1]=knownResponsive[x[1]][0]),W=x[2];for(;null!==(y=g.exec(x[2]));)(pe=x[1]+"_"+y[1])in I?I[pe]+=" "+y[2]:I[pe]=y[2],W=W.toString().replace(y[0],"");W.length>0&&(x[1]in I?I[x[1]]+=" "+W:I[x[1]]=W),M=M.toString().replace(x[0],"")}for(D in I.main=M,I)if("string"==typeof I[D]){if(z="",_=[],F=!0,V="",J=!1,le=!1,k=I[D].split(/(\s+)/).filter(e=>e.trim().length>0),D.indexOf("_")>-1?(V=D,Z=(Y=D.split("_",2))[0],D=Y[1]):f.test(D)?(Z=D,F=!1):"0"==D?(Z=D,F=!1):Z="",k.length>0)for(b=0;b<k.length;b++)fe=O=k[b],de=O.toLowerCase(),[de,ue]=hiwindImportant(de,D,"-"),de.indexOf("-")<0&&de.indexOf("[")<0&&"object"==typeof knownCSS&&(de in knownCSS?O=knownCSS[de]+ue:(de=de.toString().replace(/[^a-z0-9]/g,""))in knownCSS&&(O=knownCSS[de]+ue)),s.test(O)?(customCSS[O.substr(1,O.length-2)]=!0,O in sameCSS?q[O]=sameCSS[O]:(q[O]="",le=!0)):["retain","keep","my"].includes(D)||O.indexOf("-")<0||0==O.indexOf("bi-")||0==O.indexOf("fa-")?!1===K.includes(O)&&(K[K.length]=O):($="",P="",re=O,[O,$,P]=hiwindClass(O),O.indexOf("=")>-1?(C=(we=O.split("=",2))[0].split("-"))[C.length]=we[1]:C=O.split("-"),C[0].indexOf(":")>-1?(ce=C[0].split(":",2),C[0]=ce[1],(Z=ce[0])in knownResponsive?Z=knownResponsive[Z][0]:c.test(C[0])&&(Z=C[0],C.shift())):C[0]in knownResponsive?(Z=knownResponsive[C[0]][0],C.shift()):c.test(C[0])&&(Z=C[0],C.shift()),0==O.indexOf("display")?(L=C.shift(),E=C.join("-").trim()):(E=C.pop(),L=C.join("-").trim()),"object"==typeof knownCSS&&(de=L.toLowerCase(),[de,ue]=hiwindImportant(de,D,"-"),["important","!","!important"].includes(D)&&(ue="",P.indexOf("!important")<0&&(P+="!important")),de in knownCSS?L=knownCSS[de]:(de=de.toString().replace(/[^a-z0-9]/g,""))in knownCSS&&(L=knownCSS[de]),L+=ue),E.indexOf("/")>-1&&(E=-1==O.indexOf("family")?E.toString().replace(/\//g," "):'"'+E.toString().replace(/\//g," ")+'"'),(L.indexOf("color")>-1||L.indexOf("background")>-1)&&(oe=100,he="",E.indexOf("*")>-1?he="*":E.indexOf("@")>-1?he="@":E.indexOf("~")>-1&&(he="~"),he.length>0&&(ae=E.split(he,2),E=ae[0],ae.length>1&&(oe=parseInt(ae[1]))),(E=E.toString().replace("#",""))in hexColors&&(E=hexColors[E].trim()),l.test(E)&&(100!=oe&&(E=hiwindShade(E,oe)),E="#"+hiwindHex(E))),0==D.indexOf("+")&&(Z=""),z+=B=$+L+":"+E+P+";",!0===hiwindWebKit(L)&&(B+=$+"-webkit-"+L+":"+E+P+";",B+=$+"-moz-"+L+":"+E+P+";",B+=$+"-ms-"+L+":"+E+P+";",B+=$+"-o-"+L+":"+E+P+";"),!1===r.minifyclasses?(de="","main"!==D&&(F||(de+="width-"),de+=D+"-"),de=hiwindSafeClass(de+=re),se[se.length]=[O,fe,B,D,Z]):_[_.length]=[Z,B,V,D]);for(H in T="",G=!1,Se=Z+"-"+z,!le&&z.length>0&&A.length>0&&(z=A+"{"+z+"}",j=""),Se.length>0&&Se in v?j=v[Se]:j.length>0?G=!0:(j=hiwindID(Object.keys(v).length.toString().length),v[Se]=j),q)0==q[H].length?sameCSS[H]=j:-1==T.indexOf(sameCSS[H]+" ")&&(T+=sameCSS[H]+" ");if(z.length>0||T.length>0){if(J="",A="",be="",F&&([A,J,be]=hiwindModifier(D)),D.length>0&&"all"==Z&&(A=" *"+A),_.length>0)for(ie=J+"."+j+A,b=0;b<_.length;b++)ne=_[b][0],te=_[b][1],"all"==ne&&(ne=""),ne.length>0?(ne in responsiveCSS==!1&&(responsiveCSS[ne]={}),te in responsiveCSS[ne]==!1?responsiveCSS[ne][te]=ie:-1==responsiveCSS[ne][te].indexOf(ie)&&(responsiveCSS[ne][te]+=","+ie)):le?ie in fixedCSS==!1?fixedCSS[ie]=te:fixedCSS[ie]+=te:te in groupCSS==!1?groupCSS[te]=ie:-1==groupCSS[te].indexOf(ie)&&(groupCSS[te]+=","+ie);!0===r.minifyclasses&&(!G||T.length>0)&&(_.length>0&&j.length>0&&!1===K.includes(j)&&(K[K.length]=j),T.length>0&&!1===K.includes(T.trim())&&(K[K.length]=T.trim()))}}if(se.length>0){for(K=[],b=0;b<se.length;b++)D=se[b][3],[A,J,be]=hiwindModifier(D),ne=se[b][4],se[b][0]=hiwindSafeClass(se[b][0]),se[b][1]=hiwindSafeClass(se[b][1]),ne.length>0?(ie=J+"."+se[b][1],te=se[b][2],A.length>0&&(ie+=A),ne in responsiveCSS==!1&&(responsiveCSS[ne]={}),te in responsiveCSS[ne]==!1&&(responsiveCSS[ne][te]=ie)):fixedCSS[J+"."+se[b][1]+A]=se[b][2],ee=se[b][1],!1===K.includes(ee)&&(K[K.length]=ee);for(H in q)0==q[H].length&&(sameCSS[H]=K.join(" ").trim())}T.length>0&&!0===K.includes(T.trim())&&(T=""),(K.length>0||T.length>0)&&(u=u.toString().replace(S[0],'class="'+T+K.join(" ").trim()+'"'))}if(ye in prevClasses==!1&&(prevClasses[ye]=["","",""]),t!=prevClasses[ye][0]){for(var ve in m=!0,groupCSS)groupCSS[ve]in U?U[groupCSS[ve]]+=" "+ve:U[groupCSS[ve]]=ve;for(var ke in fixedCSS)"string"==typeof fixedCSS[ke]&&(h+=o[0]+ke+"{"+o[1]+fixedCSS[ke]+o[0]+"}");for(var Ce in U)"string"==typeof U[Ce]&&(h+=o[0]+Ce+"{"+o[1]+U[Ce]+o[0]+"}");var Oe=[];for(var Ee in responsiveCSS)"string"==typeof Ee&&Oe.unshift(Ee);Oe.sort(function(e,i){return i-e});var Le="";for(b=0;b<Oe.length;b++)if((Le=Oe[b])in responsiveCSS){for(var ze in R=[],h+="0"==Le?o[0]+"@media print {":Le in knownResponsive?o[0]+"@media screen and (min-width:"+knownResponsive[Le][0]+"px) and (max-width:"+knownResponsive[Le][1]+"px) {":o[0]+"@media screen and (max-width:"+responsiveCSS[Le][0]+"px) {",responsiveCSS[Le])responsiveCSS[Le][ze]in R?R[responsiveCSS[Le][ze]]+=" "+ze:R[responsiveCSS[Le][ze]]=ze;for(var Me in R)"string"==typeof R[Me]&&(h+=o[1]+Me+"{"+o[2]+R[Me]+o[1]+"}");h+=o[0]+"}"}!0===r.minifycss&&(h=h.toString().replace(/;\}/g,"}").toString().replace(/\{ /g,"{").toString().replace(/; /g,";")),!0===r.minifyhtml&&(u=u.toString().replace(/[\n|\r|\t]/gm,"")),prevClasses[ye]=[t,h.toString().trim(),u.toString().trim()]}return[!0,prevClasses[ye][1],prevClasses[ye][2],m]}

module.exports = function(knowhtml) {
	return hiwindCSS({
		"innerHTML": knowhtml,
		"id": "root"
	}, null, null);
};
